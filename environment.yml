# =============================================================================
# DGGS Benchmark Replication - Conda/Mamba Environment
# =============================================================================
#
# This file defines the complete Python environment for the DGGS benchmark
# replication. Using mamba/conda ensures clean GDAL installation without
# version conflicts.
#
# Usage (local):
#   mamba env create -f environment.yml
#   mamba activate dggs-replication
#
# Usage (Docker with micromamba):
#   micromamba install -y -n base -f environment.yml
#
# Replication of: Law & Ardo (2024)
# "Using a discrete global grid system for a scalable, interoperable, 
# and reproducible system of land-use mapping"
# https://doi.org/10.1080/20964471.2024.2429847
# =============================================================================

name: dggs-replication

channels:
  - conda-forge
  - defaults

dependencies:
  # ---------------------------------------------------------------------------
  # Core geospatial - from conda-forge for clean GDAL integration
  # Using loose version ranges to let conda find compatible builds
  # ---------------------------------------------------------------------------
  - gdal>=3.6,<4.0
  - geopandas>=0.14
  - rasterio>=1.3
  - fiona>=1.9
  - shapely>=2.0
  - pyproj>=3.6
  
  # ---------------------------------------------------------------------------
  # Data processing
  # ---------------------------------------------------------------------------
  - numpy>=1.26
  - pandas>=2.2
  - pyarrow>=15.0
  
  # ---------------------------------------------------------------------------
  # Visualization
  # ---------------------------------------------------------------------------
  - matplotlib>=3.8
  - seaborn>=0.13
  
  # ---------------------------------------------------------------------------
  # Utilities
  # ---------------------------------------------------------------------------
  - tqdm>=4.66
  - click>=8.1
  - pyyaml>=6.0
  - psutil>=5.9
  
  # ---------------------------------------------------------------------------
  # Pip packages (not available in conda-forge or need specific versions)
  # THESE ARE PINNED FOR REPRODUCIBILITY
  # ---------------------------------------------------------------------------
  - pip
  - pip:
    # H3 DGGS - CRITICAL: h3pandas must be >=0.3.7 to work with vector2dggs
    # DO NOT USE 0.2.6 - it is incompatible
    - h3==3.7.7
    - h3pandas==0.3.7
    
    # Paper authors' optimized DGGS tools - pinned for reproducibility
    - vector2dggs==0.10.1
    - raster2dggs==0.2.6
    
    # NLM raster generation
    - nlmpy==1.0.1
    
    # Memory profiling
    - memory_profiler==0.61.0
    
    # Jupyter for interactive analysis
    - jupyter==1.0.0
    - ipykernel==6.29.0
    
    # Parquet support (optional but recommended)
    - fastparquet==2024.2.0
